# CASL2シミュレータ 優先順位付き作業リスト

## 最優先タスク
1. assembler_test.jsの失敗しているテストケースの修正
   a. "Complex program with labels"テストケースの失敗原因の詳細な分析と修正
   b. "Invalid operand"テストケースの期待値と実際の動作の不一致の解決

2. casl2-assembler.jsファイルの修正
   a. assembleRRメソッド: 即値処理のさらなる改善
   b. resolveAddressメソッド: 無効なラベルの検出方法の再検討
   c. assembleLineメソッド: ADDA、SUBA命令の即値処理の再確認

3. カバレッジの低いファイルのテスト強化
   a. casl2-ui.jsのテストケース作成と実装
   b. debugger.jsのテストケース作成と実装
   c. casl2-test-suite.jsのテストケース作成と実装

## 高優先度タスク
4. エラー処理とバリデーションの強化
   a. 各命令実行時のエラーチェックを追加
   b. ユーザー入力のバリデーションを改善
   c. エラーメッセージをより詳細で分かりやすいものに更新
   d. プログラム実行中に発生する可能性のあるエラーの処理を改善
      - アドレス範囲外アクセス
      - 不正な命令コード
      - スタックオーバーフロー/アンダーフロー
      - 入力データの形式エラー

5. テストカバレッジの向上
   a. 新しく実装した命令のテストケースを追加
   b. エラー処理のテストケースを追加
   c. エッジケースや境界値のテストを追加

6. 未実装の機能の実装
   a. マクロ定義の解析と展開機能の実装
   b. シフト量が8ビットを超える場合の処理の実装
   c. 各命令でのオーバーフロー処理の完全実装

## 中優先度タスク
7. ユーザーインターフェースの改善
   a. Canvas APIを使用した視覚化機能の追加
      - メモリ状態の視覚化
      - レジスタの状態変化のアニメーション
      - プログラム実行フローの可視化
   b. デバッグ機能の使いやすさ向上
   c. レスポンシブデザインの適用

8. パフォーマンスの最適化
   a. 大規模なプログラムの実行時のパフォーマンス改善
   b. パフォーマンステストの追加と実装

9. 隠しコマンド（MULA、MULL、DIVA、DIVL）の実装
   a. これらの命令の仕様を確認
   b. 実装方法を検討
   c. テストケースの作成
   d. UIでの表示方法を検討

## 低優先度タスク
10. コードのクリーンアップと最適化
    a. 各テストファイルとcasl2-core.jsを再確認し、コードの可読性や効率性を向上
    b. モジュール間の依存関係の見直しと循環参照の排除

11. ドキュメンテーションの更新
    a. README.md、SPECIFICATION.md、DEVELOPMENT.mdを最新の変更を反映させるよう更新
    b. ユーザーマニュアルの作成
    c. コードコメントの追加と改善

12. セキュリティの強化
    a. ユーザー入力のバリデーション強化
    b. クロスサイトスクリプティング（XSS）対策の実装

注意事項:
- 各タスクの実行時は、既存のコードの構造を維持しながら新機能を追加すること。
- 修正や機能追加の際は、他の機能への影響を慎重に検討し、回帰テストを実施すること。
- テスト実行後は必ずユーザーに結果を報告し、確認を得てから次のステップに進むこと。
- コードの修正時は、ファイルの完全な内容を維持し、省略を避けること。
- カバレッジレポートを定期的に生成し、進捗を把握すること。
